<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Bot Scheduler | Master Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #0f172a;
            --card-bg: #1e293b;
            --accent: #6366f1;
            --accent-glow: rgba(99, 102, 241, 0.3);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --success: #22c55e;
            --warning: #f59e0b;
            --glass: rgba(30, 41, 59, 0.7);
            --border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Outfit', sans-serif;
        }

        body {
            background-color: var(--bg);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(99, 102, 241, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(99, 102, 241, 0.05) 0%, transparent 20%);
        }

        header {
            padding: 2rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--glass);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(to right, #818cf8, #c084fc);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        main {
            flex: 1;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .case-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .case-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 10px 30px -10px var(--accent-glow);
        }

        .case-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--accent);
            opacity: 0.5;
        }

        .case-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .case-id {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            color: var(--accent);
            background: var(--accent-glow);
            padding: 0.2rem 0.6rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
        }

        .case-status {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .case-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .tech-stack {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .tech-tag {
            font-size: 0.75rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-test {
            margin-top: auto;
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: filter 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-test:hover {
            filter: brightness(1.2);
        }

        .btn-test:active {
            transform: scale(0.98);
        }

        #terminal-area {
            max-width: 1200px;
            margin: 0 auto 2rem;
            padding: 0 1rem;
            width: 100%;
        }

        .terminal {
            background: #000;
            border-radius: 0.75rem;
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            border: 1px solid var(--border);
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: 0 20px 50px -20px rgba(0, 0, 0, 0.5);
        }

        .term-header {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid #333;
            padding-bottom: 0.5rem;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot.red {
            background: #ff5f56;
        }

        .dot.yellow {
            background: #ffbd2e;
        }

        .dot.green {
            background: #27c93f;
        }

        .log-entry {
            margin-bottom: 0.4rem;
            line-height: 1.4;
            color: #d1d5db;
        }

        .log-entry.info {
            color: #818cf8;
        }

        .log-entry.success {
            color: #22c55e;
        }

        .log-entry.cmd {
            color: #f59e0b;
        }

        .log-entry.meta {
            color: #64748b;
            font-style: italic;
        }

        footer {
            padding: 2rem;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid var(--border);
        }

        .case-result {
            margin-top: 0.75rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            display: none;
            max-height: 120px;
            overflow-y: auto;
        }

        .case-result.pass {
            display: block;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #22c55e;
        }

        .case-result.fail {
            display: block;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        .case-result.testing {
            display: block;
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #f59e0b;
        }

        .status-pass {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
        }

        .status-fail {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .status-testing {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
        }

        .summary-bar {
            max-width: 1200px;
            margin: 0 auto 1rem;
            padding: 1rem;
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .summary-stat {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            background: var(--card-bg);
            border: 1px solid var(--border);
        }

        @media (max-width: 768px) {
            main {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <header>
        <h1>Social Bot Scheduler: Matriz de Integraci√≥n</h1>
        <p>Automatizaci√≥n avanzada: Orquestaci√≥n Multi-Eje mediante n8n</p>
        <div style="display: flex; gap: 0.5rem; justify-content: center; margin-top: 1rem; flex-wrap: wrap;">
            <button class="btn-test" style="background: var(--success);" id="btn-run-all">
                üöÄ PROBAR INTEGRACI√ìN GLOBAL (TODOS LOS CASOS)
            </button>
            <button class="btn-test" style="background: #6366f1;" id="btn-health">
                ü©∫ Health Check n8n
            </button>
        </div>
    </header>

    <div class="summary-bar" id="summary-bar" style="display: none;">
        <span class="summary-stat" id="stat-total">Total: 0/8</span>
        <span class="summary-stat status-pass" id="stat-pass">‚úÖ Pass: 0</span>
        <span class="summary-stat status-fail" id="stat-fail">‚ùå Fail: 0</span>
    </div>

    <main id="cases-container">
        <!-- Case 01 -->
        <div class="case-card" data-case="01">
            <div class="case-header">
                <span class="case-id">CASE-01</span>
                <span class="case-status" id="status-01">READY</span>
            </div>
            <h3 class="case-title">Python ‚ûî n8n ‚ûî PHP</h3>
            <div class="tech-stack">
                <span class="tech-tag">FastAPI</span>
                <span class="tech-tag">Pydantic</span>
                <span class="tech-tag">PHP 8.x</span>
            </div>
            <button class="btn-test" id="btn-01">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-01"></div>
        </div>

        <!-- Case 02 -->
        <div class="case-card" data-case="02">
            <div class="case-header">
                <span class="case-id">CASE-02</span>
                <span class="case-status" id="status-02">READY</span>
            </div>
            <h3 class="case-title">Python ‚ûî n8n ‚ûî Go</h3>
            <div class="tech-stack">
                <span class="tech-tag">Requests</span>
                <span class="tech-tag">Gin Gonic</span>
                <span class="tech-tag">Go Modules</span>
            </div>
            <button class="btn-test" id="btn-02">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-02"></div>
        </div>

        <!-- Case 03 -->
        <div class="case-card" data-case="03">
            <div class="case-header">
                <span class="case-id">CASE-03</span>
                <span class="case-status" id="status-03">READY</span>
            </div>
            <h3 class="case-title">Go ‚ûî n8n ‚ûî Node.js</h3>
            <div class="tech-stack">
                <span class="tech-tag">Go Net/Http</span>
                <span class="tech-tag">Express.js</span>
                <span class="tech-tag">PM2</span>
            </div>
            <button class="btn-test" id="btn-03">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-03"></div>
        </div>

        <!-- Case 04 -->
        <div class="case-card" data-case="04">
            <div class="case-header">
                <span class="case-id">CASE-04</span>
                <span class="case-status" id="status-04">READY</span>
            </div>
            <h3 class="case-title">Node.js ‚ûî n8n ‚ûî FastAPI</h3>
            <div class="tech-stack">
                <span class="tech-tag">Axios</span>
                <span class="tech-tag">Uvicorn</span>
                <span class="tech-tag">Pydantic V2</span>
            </div>
            <button class="btn-test" id="btn-04">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-04"></div>
        </div>

        <!-- Case 05 -->
        <div class="case-card" data-case="05">
            <div class="case-header">
                <span class="case-id">CASE-05</span>
                <span class="case-status" id="status-05">READY</span>
            </div>
            <h3 class="case-title">Laravel ‚ûî n8n ‚ûî React</h3>
            <div class="tech-stack">
                <span class="tech-tag">Artisan CLI</span>
                <span class="tech-tag">Vite</span>
                <span class="tech-tag">PostCSS</span>
            </div>
            <button class="btn-test" id="btn-05">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-05"></div>
        </div>

        <!-- Case 06 -->
        <div class="case-card" data-case="06">
            <div class="case-header">
                <span class="case-id">CASE-06</span>
                <span class="case-status" id="status-06">READY</span>
            </div>
            <h3 class="case-title">Go ‚ûî n8n ‚ûî Symfony</h3>
            <div class="tech-stack">
                <span class="tech-tag">Go Compiler</span>
                <span class="tech-tag">Twig</span>
                <span class="tech-tag">Doctrine</span>
            </div>
            <button class="btn-test" id="btn-06">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-06"></div>
        </div>

        <!-- Case 07 -->
        <div class="case-card" data-case="07">
            <div class="case-header">
                <span class="case-id">CASE-07</span>
                <span class="case-status" id="status-07">READY</span>
            </div>
            <h3 class="case-title">Rust ‚ûî n8n ‚ûî Ruby</h3>
            <div class="tech-stack">
                <span class="tech-tag">Reqwest</span>
                <span class="tech-tag">Sinatra</span>
                <span class="tech-tag">Cargo</span>
            </div>
            <button class="btn-test" id="btn-07">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-07"></div>
        </div>

        <!-- Case 08 -->
        <div class="case-card" data-case="08">
            <div class="case-header">
                <span class="case-id">CASE-08</span>
                <span class="case-status" id="status-08">READY</span>
            </div>
            <h3 class="case-title">C# ‚ûî n8n ‚ûî Flask</h3>
            <div class="tech-stack">
                <span class="tech-tag">.NET 6.0</span>
                <span class="tech-tag">Flask</span>
                <span class="tech-tag">Jinja2</span>
            </div>
            <button class="btn-test" id="btn-08">üîó Probar Integraci√≥n</button>
            <div class="case-result" id="result-08"></div>
        </div>
    </main>

    <div id="terminal-area">
        <div class="terminal" id="terminal">
            <div class="term-header">
                <div class="dot red"></div>
                <div class="dot yellow"></div>
                <div class="dot green"></div>
                <div style="margin-left: 10px; color: #555">bash ‚Äî integration-logger</div>
            </div>
            <div class="log-entry meta">Esperando acci√≥n... Selecciona un caso para probar.</div>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 Social Bot Scheduler - Laboratorio de Automatizaci√≥n</p>
    </footer>

    <script>
        // ==============================================================================
        // CONFIGURACI√ìN DE CASOS
        // ==============================================================================
        // Cada caso define su webhook path en n8n y el puerto donde corre el destino.
        // El flujo real es: POST ‚Üí n8n webhook ‚Üí n8n procesa ‚Üí n8n env√≠a al destino.
        const CASES = {
            '01': { webhook: 'social-bot-scheduler-php', port: 8081, origin: 'Python', dest: 'PHP' },
            '02': { webhook: 'social-bot-scheduler-go', port: 8082, origin: 'Python', dest: 'Go' },
            '03': { webhook: 'social-bot-scheduler-node', port: 8083, origin: 'Go', dest: 'Node.js' },
            '04': { webhook: 'social-bot-scheduler-fastapi', port: 8084, origin: 'Node.js', dest: 'FastAPI' },
            '05': { webhook: 'social-bot-scheduler-react', port: 8085, origin: 'Laravel', dest: 'React' },
            '06': { webhook: 'social-bot-scheduler-symfony', port: 8086, origin: 'Go', dest: 'Symfony' },
            '07': { webhook: 'social-bot-scheduler-ruby', port: 8087, origin: 'Rust', dest: 'Ruby' },
            '08': { webhook: 'social-bot-scheduler-flask', port: 8088, origin: 'C#', dest: 'Flask' }
        };

        const N8N_BASE = 'http://localhost:5678';
        const terminal = document.getElementById('terminal');
        let testResults = { pass: 0, fail: 0, total: 0 };

        // ==============================================================================
        // LOGGING
        // ==============================================================================
        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `log-entry ${type}`;
            const time = new Date().toLocaleTimeString();
            div.innerHTML = `<span style="color: #444">[${time}]</span> ${msg}`;
            terminal.appendChild(div);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function clearTerminal(title) {
            terminal.innerHTML = `
                <div class="term-header">
                    <div class="dot red"></div>
                    <div class="dot yellow"></div>
                    <div class="dot green"></div>
                    <div style="margin-left: 10px; color: #555">bash ‚Äî ${title}</div>
                </div>
            `;
        }

        // ==============================================================================
        // STATUS MANAGEMENT
        // ==============================================================================
        function setStatus(caseId, status, text) {
            const el = document.getElementById(`status-${caseId}`);
            el.textContent = text || status.toUpperCase();
            el.className = `case-status status-${status}`;
        }

        function setResult(caseId, status, html) {
            const el = document.getElementById(`result-${caseId}`);
            el.className = `case-result ${status}`;
            el.innerHTML = html;
        }

        function updateSummary() {
            document.getElementById('summary-bar').style.display = 'flex';
            document.getElementById('stat-total').textContent = `Total: ${testResults.pass + testResults.fail}/8`;
            document.getElementById('stat-pass').textContent = `‚úÖ Pass: ${testResults.pass}`;
            document.getElementById('stat-fail').textContent = `‚ùå Fail: ${testResults.fail}`;
        }

        // ==============================================================================
        // HEALTH CHECK
        // ==============================================================================
        async function checkHealth() {
            clearTerminal('health-check');
            log('ü©∫ Verificando salud de n8n...', 'info');

            try {
                const resp = await fetch(`${N8N_BASE}/healthz`, { signal: AbortSignal.timeout(5000) });
                if (resp.ok) {
                    log('‚úÖ n8n est√° HEALTHY y respondiendo', 'success');
                    log(`   Status: ${resp.status} ${resp.statusText}`, 'meta');
                } else {
                    log(`‚ö†Ô∏è n8n respondi√≥ con status ${resp.status}`, 'cmd');
                }
            } catch (e) {
                log(`‚ùå n8n no est√° disponible: ${e.message}`, 'cmd');
                log('   Aseg√∫rate de que Docker est√° corriendo: docker-compose up -d', 'meta');
            }

            // Check each destination port
            log('', 'meta');
            log('üîç Verificando destinos...', 'info');
            for (const [id, cfg] of Object.entries(CASES)) {
                try {
                    const resp = await fetch(`http://localhost:${cfg.port}`, {
                        signal: AbortSignal.timeout(3000),
                        mode: 'no-cors'
                    });
                    log(`   Case ${id} (${cfg.dest} :${cfg.port}): ‚úÖ Respondiendo`, 'success');
                } catch (e) {
                    log(`   Case ${id} (${cfg.dest} :${cfg.port}): ‚ùå No responde`, 'cmd');
                }
            }
        }

        // ==============================================================================
        // RUN SINGLE CASE - REAL API CALL
        // ==============================================================================
        async function runCase(id, clear = true) {
            const cfg = CASES[id];
            if (!cfg) return;

            if (clear) clearTerminal(`testing case ${id}`);

            setStatus(id, 'testing', 'TESTING...');
            setResult(id, 'testing', '‚è≥ Ejecutando prueba...');

            const timestamp = new Date().toISOString();
            const uniqueId = `test-${id}-${Date.now()}`;

            // Payload real que simula lo que el bot enviar√≠a
            const payload = {
                id: uniqueId,
                text: `[TEST] Mensaje de prueba Case ${id}: ${cfg.origin} ‚Üí ${cfg.dest} @ ${timestamp}`,
                channel: 'integration-test',
                scheduled_at: timestamp
            };

            log(`üîß Iniciando prueba: <b>CASO-${id}</b> (${cfg.origin} ‚ûî n8n ‚ûî ${cfg.dest})`, 'info');
            log(`   Webhook: ${N8N_BASE}/webhook/${cfg.webhook}`, 'meta');
            log(`   Payload ID: ${uniqueId}`, 'meta');

            // Paso 1: POST al webhook de n8n
            log(`üì§ Enviando POST a n8n webhook...`, 'cmd');
            let n8nOk = false;
            let n8nResponse = '';

            try {
                const resp = await fetch(`${N8N_BASE}/webhook/${cfg.webhook}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    signal: AbortSignal.timeout(15000)
                });

                n8nResponse = await resp.text();
                let parsed;
                try { parsed = JSON.parse(n8nResponse); } catch { parsed = n8nResponse; }

                if (resp.ok) {
                    n8nOk = true;
                    log(`‚úÖ n8n respondi√≥: ${resp.status} ${resp.statusText}`, 'success');
                    log(`   Response: ${JSON.stringify(parsed).substring(0, 200)}`, 'meta');
                } else {
                    log(`‚ùå n8n error: ${resp.status} ${resp.statusText}`, 'cmd');
                    log(`   Body: ${n8nResponse.substring(0, 200)}`, 'meta');
                }
            } catch (e) {
                log(`‚ùå Error conectando a n8n: ${e.message}`, 'cmd');
                n8nResponse = e.message;
            }

            // Paso 2: Verificar que el destino recibi√≥ los datos
            if (n8nOk) {
                log(`üîç Verificando destino ${cfg.dest} en puerto ${cfg.port}...`, 'info');
                await wait(1000); // Dar tiempo al destino para procesar

                try {
                    const destResp = await fetch(`http://localhost:${cfg.port}`, {
                        signal: AbortSignal.timeout(5000)
                    });
                    if (destResp.ok) {
                        log(`‚úÖ Destino ${cfg.dest} (puerto ${cfg.port}) est√° respondiendo`, 'success');
                    } else {
                        log(`‚ö†Ô∏è Destino respondi√≥ con status ${destResp.status}`, 'cmd');
                    }
                } catch (e) {
                    log(`‚ö†Ô∏è No se pudo verificar destino: ${e.message}`, 'cmd');
                }
            }

            // Resultado final
            if (n8nOk) {
                setStatus(id, 'pass', '‚úÖ PASS');
                setResult(id, 'pass',
                    `<b>‚úÖ Integraci√≥n exitosa</b><br>` +
                    `ID: ${uniqueId}<br>` +
                    `n8n ‚Üí ${cfg.dest}: OK<br>` +
                    `Response: ${n8nResponse.substring(0, 100)}...`
                );
                log(`‚úÖ CASO-${id} COMPLETADO EXITOSAMENTE`, 'success');
                testResults.pass++;
            } else {
                setStatus(id, 'fail', '‚ùå FAIL');
                setResult(id, 'fail',
                    `<b>‚ùå Error en integraci√≥n</b><br>` +
                    `Causa: ${n8nResponse.substring(0, 150)}<br>` +
                    `Verifica: docker-compose ps`
                );
                log(`‚ùå CASO-${id} FALL√ì`, 'cmd');
                testResults.fail++;
            }

            testResults.total++;
            updateSummary();
            return n8nOk;
        }

        // ==============================================================================
        // RUN ALL CASES
        // ==============================================================================
        async function runAllCases() {
            testResults = { pass: 0, fail: 0, total: 0 };
            clearTerminal('global-integration-test');

            log('üöÄ INICIANDO SECUENCIA MAESTRA DE PRUEBAS', 'info');
            log(`   Fecha: ${new Date().toLocaleString()}`, 'meta');
            log(`   n8n: ${N8N_BASE}`, 'meta');
            log('', 'meta');

            // Reset all statuses
            for (const id of Object.keys(CASES)) {
                setStatus(id, 'testing', 'PENDING');
                setResult(id, 'testing', '‚è≥ En cola...');
            }

            for (const id of Object.keys(CASES)) {
                log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'meta');
                await runCase(id, false);
                await wait(1000); // Pausa entre casos
            }

            log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'meta');
            log('', 'meta');

            if (testResults.fail === 0) {
                log('üéâ TODAS LAS INTEGRACIONES COMPLETADAS EXITOSAMENTE', 'success');
            } else {
                log(`‚ö†Ô∏è Resultado: ${testResults.pass} exitosos, ${testResults.fail} fallidos`, 'cmd');
            }

            log(`üìä Resumen: ${testResults.pass}/${testResults.total} casos pasaron`, 'info');
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ==============================================================================
        // EVENT LISTENERS (CSP-safe, no inline handlers)
        // ==============================================================================
        document.getElementById('btn-run-all').addEventListener('click', runAllCases);
        document.getElementById('btn-health').addEventListener('click', checkHealth);

        for (const id of Object.keys(CASES)) {
            document.getElementById(`btn-${id}`).addEventListener('click', () => runCase(id));
        }
    </script>
</body>

</html>